-- FreeFem++ v  3.610001 (date jeu. 12 juil. 2018 15:05:23)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : load "ff-IpOpt"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\ff-IpOpt = 0)
    2 : load "medit"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\medit = 0)
    3 :
    4 : real T = 1;
    5 : int nn = 50;
    6 : int Nx = nn, Ny = nn;
    7 : int[int] labs = [1, 2, 0, 4];
    8 : mesh Th = square(Nx, Ny, [x, T * y], label = labs);
    9 : fespace Vh(Th, P1);
   10 :
   11 :
   12 : // ***** DATA ***** //
   13 : Vh ue = exp(y) * sin(pi * x);
   14 : Vh uD = 0;
   15 : Vh u0 = sin(pi * x);
   16 :
   17 : Vh fe = x^2;//sin(pi * x);
   18 :
   19 : Vh q = 2 + y^2;
   20 : Vh g = (1 + pi^2) * ue(x, y) - fe(x, y) * q(x,y);
   21 : real gamma = 1e-1;
   22 :
   23 : // The final overdetermination
   24 : real[int] w(Nx + 1);
   25 : for (int i = 0; i <= Nx; i++){
   26 :     w[i] = ue(i * 1.0 / Nx, T);
   27 : }
   28 :
   29 : real[int] ffe(Nx + 1);
   30 : for (int i = 0; i <= Nx; i++){
   31 :     ffe[i] = fe(1.0 * i / Nx, 0);
   32 : }
   33 :
   34 :
   35 :
   36 :
   37 :
   38 : // ***** Functions to modify matrix ***** //
   39 :
   40 : // ** Change the time direction
   41 : func real[int] FlipTimeDirection(real[int] mat){
   42 :     Vh res;
   43 :     for (int i = 0; i <= Ny/2; i++){
   44 :         for (int j = 0; j <= Nx; j++){
   45 :             res[][i * (Nx + 1) + j] = mat[(Ny - i) * (Nx + 1) + j];
   46 :             res[][(Ny - i) * (Nx + 1) + j] = mat[i * (Nx + 1) + j];
   47 :         }
   48 :     }
   49 :     return res[];
   50 : }
   51 :
   52 : // ** To change vec(t) into vec(x, t) depending on the mesh
   53 : func real[int] TimeToQ(real[int] mat){
   54 :     Vh res = 0;
   55 :     for (int i = 0; i <= Ny; i++){
   56 :         for (int j = 0; j <= Nx; j++)
   57 :         res[][i * (Nx + 1) + j] = mat[i];
   58 :     }
   59 :     return res[];
   60 : }
   61 :
   62 : // ** To change vec(x) into vec(x, t) depending on the mesh
   63 : func real[int] SpaceToQ(real[int] mat){
   64 :     Vh res = 0;
   65 :     for (int i = 0; i <= Nx; i++){
   66 :         for (int j = 0; j <= Ny; j++)
   67 :         res[][j * (Nx + 1) + i] = mat[i];
   68 :     }
   69 :     return res[];
   70 : }
   71 :
   72 : // ** Get values from final time (t = T)
   73 : func real[int] GetFinalTime(real[int] mat){
   74 :     real[int] res(Nx + 1);
   75 :     for (int i = 0; i <= Nx; i++){
   76 :         res[i] = mat[Ny * (Nx + 1) + i];
   77 :     }
   78 :     return res;
   79 : }
   80 :
   81 : // ** Get values from initial time (t = 0)
   82 : func real[int] GetInitialTime(real[int] mat){
   83 :     real[int] res(Nx + 1);
   84 :     for (int i = 0; i <= Nx; i++){
   85 :         res[i] = mat[i];
   86 :     }
   87 :     return res;
   88 : }
   89 :
   90 : // ** Integrate on space
   91 : //   The result is a vector with respect to (t)
   92 : func real[int] IntegralOnSpace(real[int] mat){
   93 :     real[int] res(Ny + 1);
   94 :     Vh temp = 0;
   95 :     for (int i = 0; i <= Ny; i++){
   96 :         for (int j = 0; j <= Nx; j++){
   97 :             temp[][j] = mat[i * (Nx + 1) + j];
   98 :         }
   99 :         res[i] = int1d(Th, 1)(temp);
  100 :     }
  101 :     return res;
  102 : }
  103 :
  104 : // * Integrate on time
  105 : //   The result is a vector with respect to (x)
  106 : func real[int] IntegralOnTime(real[int] mat){
  107 :     real[int] res(Nx + 1);
  108 :     Vh temp = 0;
  109 :     for (int i = 0; i <= Nx; i++){
  110 :         for (int j = 0; j <= Ny; j++){
  111 :             temp[][j * (Nx + 1)] = mat[j * (Nx + 1) + i];
  112 :         }
  113 :         res[i] = int1d(Th, 4)(temp);
  114 :     }
  115 :     return res;
  116 : }
  117 :
  118 :
  119 : // ** Inner product on time domain of vec1(t) and vec2(t)
  120 : func real InnerProductOnTime(real[int] vec1, real[int] vec2){
  121 :     real[int] vec(Ny + 1);
  122 :     for (int i = 0; i <= Ny; i++){
  123 :         vec[i] = vec1[i] * vec2[i];
  124 :     }
  125 :
  126 :     // Take int1d on x = 0 (label = 4);
  127 :     Vh res = 0;
  128 :     for (int i = 0; i <= Ny; i++){
  129 :         res[][i * (Nx + 1)] = vec[i];
  130 :     }
  131 :
  132 :     return int1d(Th, 4)(res);
  133 : }
  134 :
  135 :
  136 : // ** Inner product on time domain of vec1(x) and vec2(x)
  137 : func real InnerProductOnSpace(real[int] vec1, real[int] vec2){
  138 :     real[int] vec(Nx + 1);
  139 :     for (int i = 0; i <= Nx; i++){
  140 :         vec[i] = vec1[i] * vec2[i];
  141 :     }
  142 :
  143 :     // Take int1d on x = 0 (label = 4);
  144 :     Vh res = 0;
  145 :     for (int i = 0; i <= Nx; i++){
  146 :         res[][i] = vec[i];
  147 :     }
  148 :
  149 :     return int1d(Th, 1)(res);
  150 : }
  151 :
  152 :
  153 :
  154 :
  155 : // ***** State and Adjoint problems ***** //
  156 :
  157 : // * State problem
  158 : func real[int] StateProblem(real[int] ff){
  159 :     Vh u, v, f; f[] = SpaceToQ(ff);
  160 :     Vh rsh = q * f + g;
  161 :
  162 :     solve SpaceTime(u, v, solver = sparsesolver) =
  163 :           int2d(Th)(dy(u)  * v + dx(u)  * dx(v))
  164 :         + int2d(Th)(dy(u0) * v + dx(u0) * dx(v))
  165 :         - int2d(Th)(rsh * v)
  166 :         + on(1, 2, 4, u = 0);
  167 :
  168 :     u = u + u0;
  169 :     return u[];
  170 : }
  171 :
  172 : // * Problem 1
  173 : func real[int] StateProblem1(real[int] ff){
  174 :     Vh u, v, f; f[] = ff;
  175 :     Vh rsh = q * f;
  176 :
  177 :     solve SpaceTime(u, v, solver = sparsesolver) =
  178 :           int2d(Th)(dy(u) * v + dx(u) * dx(v))
  179 :         - int2d(Th)(rsh * v)
  180 :         + on(1, 2, 4, u = 0);
  181 :
  182 :     return u[];
  183 : }
  184 :
  185 : // * Problem 2
  186 : func real[int] StateProblem2(){
  187 :     Vh u, v;
  188 :
  189 :     solve SpaceTime(u, v, solver = sparsesolver) =
  190 :           int2d(Th)(dy(u)  * v + dx(u)  * dx(v))
  191 :         + int2d(Th)(dy(u0) * v + dx(u0) * dx(v))
  192 :         - int2d(Th)(g * v)
  193 :         + on(1, 2, 4, u = 0);
  194 :
  195 :     u = u + u0;
  196 :     return u[];
  197 : }
  198 :
  199 :
  200 : // * Adjoint problem
  201 : func real[int] AdjointProblem(real[int] uu){
  202 :     Vh p, v;
  203 :     real[int] delta = GetFinalTime(uu) - w;
  204 :     Vh pT = 0;
  205 :     for (int i = 0; i <= Nx; i++){
  206 :         pT[][i] = delta[i];
  207 :     }
  208 :     //cout << "delta min and max: " << delta.min << ", " << delta.max << endl;
  209 :     cout << "pT min and max: " << pT[].min << ", " << pT[].max << endl;
  210 :     solve SpaceTime(p, v, solver = sparsesolver) =
  211 :           int2d(Th)(dy(p) * v + dx(p) * dx(v))
  212 :         + int2d(Th)(dy(pT) * v + dx(pT) * dx(v))
  213 :         + on(2, 4, p = 0) + on(1, p = 0);
  214 :     Vh res = p + pT;
  215 :     //return p[];
  216 :     return FlipTimeDirection(res[]);
  217 : }
  218 :
  219 :
  220 : // Tikhonov functional
  221 : func real J(real[int] ff) {
  222 :     Vh u; u[] = StateProblem(ff);
  223 :     real[int] delta = GetFinalTime(u[]) - w;
  224 :     return 0.5 * InnerProductOnTime(delta, delta) + 0.5 * gamma * InnerProductOnSpace(ff, ff);
  225 : }
  226 :
  227 :
  228 : // Gradient of Tikhonov funtional
  229 : func real[int] GradJ(real[int] ff) {
  230 :     real[int] uu = StateProblem(ff);
  231 :     Vh p; p[] = AdjointProblem(uu);
  232 :     Vh qp = p * q;
  233 :     real[int] res = IntegralOnTime(qp[]) + gamma * ff;
  234 :     return res;
  235 : }
  236 :
  237 : func real Draw(real[int] f1, real[int] f2){
  238 :     Vh ff1 = 0; ff1[] = SpaceToQ(f1);
  239 :     Vh ff2 = 0; ff2[] = SpaceToQ(f2);
  240 :     /*for (int i = 0; i <= Ny; i++){
  241 :         ff1[][i * (Nx + 1)] = f1[i];
  242 :         ff2[][i * (Nx + 1)+2] = f2[i];
  243 :     }*/
  244 :     plot(ff1, ff2, wait = true, dim = 3);
  245 :     return 1;
  246 : }
  247 :
  248 :
  249 : real[int] fh(Ny + 1);
  250 : //fh = ffe;
  251 : IPOPT(J, GradJ, fh, tol = 0.5e-4);
  252 : real[int] test = ffe - fh;
  253 : cout << "(ffe - fh) min and max: " << test.min << ", " << test.max << endl;
  254 : Draw(ffe, fh);
  255 :
  256 :
  257 : /*
  258 : //******************************
  259 : // CG method
  260 :
  261 : Vh uh, ph;
  262 : real[int] fh(Ny + 1), rh(Ny + 1), dh(Ny + 1), rhold(Ny + 1);
  263 : //fh = ffe;
  264 : uh[] = StateProblem2() + StateProblem1(SpaceToQ(fh));
  265 : //cout << GetFinalTime(uh[]) << endl;
  266 : //cout << w << endl;
  267 : plot(uh, ue, wait = 1, dim=3d);
  268 :
  269 : for (int iter = 0; iter < 100; iter++){
  270 :     cout << endl << endl << endl << endl;
  271 :     cout << "==========================>>>>>>>>>>>>>> " << iter << endl;
  272 :     real[int] test = ffe - fh;
  273 :     cout << "(ffe - fh) min and max: " << test.min << ", " << test.max << endl;
  274 :     Draw(ffe, fh);
  275 :     //cout << endl << fh << endl << endl;
  276 :     cout << endl << "Adjoint problem" << endl;
  277 :     ph[] = AdjointProblem(uh[]);
  278 :     //cout << GetInitialTime(ph[]) << endl;
  279 :     real[int] delta = GetFinalTime(uh[]) - w;
  280 :     cout << delta << endl;
  281 :     cout << GetFinalTime(ph[]) << endl;
  282 :     //plot(uh, ue, wait = 1, dim=3d);
  283 :
  284 :     rhold = rh;
  285 :     Vh qp = q * ph;
  286 :     rh = -IntegralOnTime(qp[]) - gamma * fh;
  287 :     //cout << endl << rh << endl << endl;
  288 :     if (iter > 0){
  289 :         real beta = InnerProductOnSpace(rh, rh) / InnerProductOnSpace(rhold, rhold);
  290 :         dh = rh + beta * dh;
  291 :         cout << "beta: "  << beta << endl;
  292 :     }else{
  293 :         dh = rh;
  294 :     }
  295 :     //cout << endl << dh << endl << endl;
  296 :     cout << endl << "Solution udh" << endl;
  297 :     Vh udh; udh[] = StateProblem1(SpaceToQ(dh));
  298 :     real[int] tem = GetFinalTime(udh[]);
  299 :
  300 :     real alpha = InnerProductOnSpace(rh, rh) / (InnerProductOnSpace(tem, tem) + gamma * InnerProductOnSpace(dh,
è3…dh));
  301 :     cout << endl << endl;
  302 :     cout << "rh ===>>> " << rh.min <<", " << rh.max << endl;
  303 :     cout << "alpha: " << alpha << endl;
  304 :     cout << "Norm (rh, rh): " << InnerProductOnSpace(rh, rh) << ", " << InnerProductOnSpace(dh, rh)<< endl;
  305 :     Vh temp; temp[] = FlipTimeDirection(udh[]);
  306 :     cout << "Mau 1: " << int1d(Th, 1)(temp * temp) << ", " << InnerProductOnSpace(tem, tem) << endl;
  307 :     cout << "Mau 2: " << gamma * InnerProductOnSpace(dh, dh) << endl;
  308 :
  309 :     fh = fh + alpha * dh;
  310 :     //uh = uh + alpha * udh;
  311 :     uh[] = StateProblem2() + StateProblem1(SpaceToQ(fh));
  312 : }
  313 :
  314 :
  315 : plot(ue, dim=3, wait =1);
  316 : plot(uh, dim=3, wait =1);
  317 : plot(uh, ue, dim=3, wait =1);
  318 :
  319 : //
  320 : //******************************
  321 :
  322 :
  323 :
  324 : //Vh fh = 0;
  325 : //IPOPT(J, GradJ, fh[], tol = 1e-6);
  326 : //NLCG(GradJ, fh[], nbiter = 1000, eps = -1e-6);
  327 : //LinearCG(GradJ, f[], eps = 1e-6);
  328 :
  329 : //cout << "J: " << J(fh[]) << endl;
  330 :
  331 :
  332 : //savemesh(Th, "IP1.mesh");
  333 : //savesol("IP1.sol", Th, f);
  334 : //savemesh(Th, "IPe.mesh");
  335 : //savesol("IPe.sol", Th, fe);
  336 :
  337 : //plot(fe, wait = true, dim = 3);
  338 : //plot(fh, wait = true, dim = 3);
  339 : //plot(fh, fe, wait = true, dim = 3);
  340 :
  341 : //Vh delta = fh - fe;
  342 :
  343 : //cout << "kq: " << fe[].min << ", " << fe[].max << endl;
  344 : //cout << "kq: " << fh[].min << ", " << fh[].max << endl;
  345 : //cout << "delta: " << delta[].min << ", " << delta[].max << endl;
  346 : //cout << "ss: " << sqrt(int2d(Th)(delta^2)) << endl;
  347 : */ sizestack + 1024 =9256  ( 8232 )
 
  -- Square mesh : nb vertices  =2601 ,  nb triangles = 5000 ,  nb boundary edges 200
 
IPOPT Note : No hessian given ==> LBFGS hessian approximation enabled
 
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************
 
This is Ipopt version 3.12.4, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).
 
Number of nonzeros in equality constraint Jacobian...:        0
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0
 
  -- Solve :
          min -0.00976757  max 1.61362
pT min and max: -0.112425, 5.13339e-032
  -- Solve :
          min -0.0912708  max 9.12233e-034
Total number of variables............................:       51
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:        0
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0
 
  -- Solve :
          min -0.00976757  max 1.61362
pT min and max: -0.112425, 5.13339e-032
  -- Solve :
          min -0.0912708  max 9.12233e-034
  -- Solve :
          min -0.00976757  max 1.61362
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 3.1754850e-003 0.00e+000 3.16e-002   0.0 0.00e+000    -  0.00e+000 0.00e+000   0
  -- Solve :
          min -0.00894239  max 1.62266
  -- Solve :
          min -0.00894239  max 1.62266
pT min and max: -0.104049, 5.16097e-032
  -- Solve :
          min -0.08403  max 8.39715e-034
   1 2.7201639e-003 0.00e+000 2.59e-002 -11.0 3.16e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.00673604  max 1.66326
  -- Solve :
          min -0.00673604  max 1.66326
pT min and max: -0.0679122, 5.28311e-032
  -- Solve :
          min -0.0519318  max 5.18947e-034
   2 1.8040031e-003 0.00e+000 3.60e-004 -11.0 1.42e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.00670274  max 1.66324
  -- Solve :
          min -0.00670274  max 1.66324
  -- Solve :
          min -0.00670274  max 1.66324
  -- Solve :
          min -0.00670274  max 1.66324
  -- Solve :
          min -0.00670274  max 1.66324
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
   3 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.03e-003    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -0.00667923  max 1.66321
  -- Solve :
          min -0.00667923  max 1.66321
  -- Solve :
          min -0.00667923  max 1.66321
  -- Solve :
          min -0.00667923  max 1.66321
  -- Solve :
          min -0.00667923  max 1.66321
  -- Solve :
          min -0.00669931  max 1.66323
  -- Solve :
          min -0.00670935  max 1.66324
  -- Solve :
          min -0.00671437  max 1.66325
  -- Solve :
          min -0.00671688  max 1.66325
  -- Solve :
          min -0.00671813  max 1.66325
  -- Solve :
          min -0.00671876  max 1.66325
  -- Solve :
          min -0.00671907  max 1.66325
  -- Solve :
          min -0.00671923  max 1.66325
  -- Solve :
          min -0.00671931  max 1.66325
  -- Solve :
          min -0.00671935  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
   4 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.44e-003    -  1.00e+000 5.82e-011f 35
  -- Solve :
          min -0.00667976  max 1.66319
  -- Solve :
          min -0.00667976  max 1.66319
  -- Solve :
          min -0.00667976  max 1.66319
  -- Solve :
          min -0.00667976  max 1.66319
  -- Solve :
          min -0.00667976  max 1.66319
  -- Solve :
          min -0.00669958  max 1.66322
  -- Solve :
          min -0.00670948  max 1.66324
  -- Solve :
          min -0.00671444  max 1.66324
  -- Solve :
          min -0.00671691  max 1.66325
  -- Solve :
          min -0.00671815  max 1.66325
  -- Solve :
          min -0.00671877  max 1.66325
  -- Solve :
          min -0.00671908  max 1.66325
  -- Solve :
          min -0.00671923  max 1.66325
  -- Solve :
          min -0.00671931  max 1.66325
  -- Solve :
          min -0.00671935  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
   5 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.41e-003    -  1.00e+000 2.91e-011f 36
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00669962  max 1.66323
  -- Solve :
          min -0.0067095  max 1.66324
  -- Solve :
          min -0.00671445  max 1.66324
  -- Solve :
          min -0.00671692  max 1.66325
  -- Solve :
          min -0.00671815  max 1.66325
  -- Solve :
          min -0.00671877  max 1.66325
  -- Solve :
          min -0.00671908  max 1.66325
  -- Solve :
          min -0.00671923  max 1.66325
  -- Solve :
          min -0.00671931  max 1.66325
  -- Solve :
          min -0.00671935  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
   6 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.41e-003    -  1.00e+000 3.64e-012f 39
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00669962  max 1.66323
  -- Solve :
          min -0.0067095  max 1.66324
  -- Solve :
          min -0.00671445  max 1.66324
  -- Solve :
          min -0.00671692  max 1.66325
  -- Solve :
          min -0.00671815  max 1.66325
  -- Solve :
          min -0.00671877  max 1.66325
  -- Solve :
          min -0.00671908  max 1.66325
  -- Solve :
          min -0.00671923  max 1.66325
  -- Solve :
          min -0.00671931  max 1.66325
  -- Solve :
          min -0.00671935  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
   7 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.41e-003    -  1.00e+000 1.82e-012f 40
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00667985  max 1.66321
  -- Solve :
          min -0.00669962  max 1.66323
  -- Solve :
          min -0.0067095  max 1.66324
  -- Solve :
          min -0.00671445  max 1.66324
  -- Solve :
          min -0.00671692  max 1.66325
  -- Solve :
          min -0.00671815  max 1.66325
  -- Solve :
          min -0.00671877  max 1.66325
  -- Solve :
          min -0.00671908  max 1.66325
  -- Solve :
          min -0.00671923  max 1.66325
  -- Solve :
          min -0.00671931  max 1.66325
  -- Solve :
          min -0.00671935  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
   8 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.41e-003    -  1.00e+000 2.84e-014f 46
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671731  max 1.66325
  -- Solve :
          min -0.00671835  max 1.66325
  -- Solve :
          min -0.00671887  max 1.66325
  -- Solve :
          min -0.00671913  max 1.66325
  -- Solve :
          min -0.00671926  max 1.66325
  -- Solve :
          min -0.00671932  max 1.66325
  -- Solve :
          min -0.00671936  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
   9 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.54e-004    -  1.00e+000 5.68e-014f 45
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671731  max 1.66325
  -- Solve :
          min -0.00671835  max 1.66325
  -- Solve :
          min -0.00671887  max 1.66325
  -- Solve :
          min -0.00671913  max 1.66325
  -- Solve :
          min -0.00671926  max 1.66325
  -- Solve :
          min -0.00671932  max 1.66325
  -- Solve :
          min -0.00671936  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.54e-004    -  1.00e+000 5.68e-014f 45
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671731  max 1.66325
  -- Solve :
          min -0.00671835  max 1.66325
  -- Solve :
          min -0.00671887  max 1.66325
  -- Solve :
          min -0.00671913  max 1.66325
  -- Solve :
          min -0.00671926  max 1.66325
  -- Solve :
          min -0.00671932  max 1.66325
  -- Solve :
          min -0.00671936  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
  11 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.54e-004    -  1.00e+000 2.84e-014f 46
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671731  max 1.66325
  -- Solve :
          min -0.00671835  max 1.66325
  -- Solve :
          min -0.00671887  max 1.66325
  -- Solve :
          min -0.00671913  max 1.66325
  -- Solve :
          min -0.00671926  max 1.66325
  -- Solve :
          min -0.00671932  max 1.66325
  -- Solve :
          min -0.00671936  max 1.66325
  -- Solve :
          min -0.00671937  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671938  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
  -- Solve :
          min -0.00671939  max 1.66325
pT min and max: -0.0678534, 5.28273e-032
  -- Solve :
          min -0.0519153  max 5.18772e-034
  12 1.8039903e-003 0.00e+000 2.54e-004 -11.0 2.54e-004    -  1.00e+000 2.84e-014f 46
  -- Solve :
          min -0.00671523  max 1.66324
  -- Solve :
          min -0.00671523  max 1.66324
pT min and max: -0.0678408, 5.28263e-032
  -- Solve :
          min -0.0519134  max 5.1875e-034
  13 1.8039931e-003 0.00e+000 2.28e-004 -11.0 2.54e-004    -  1.00e+000 1.00e+000w  1
  -- Solve :
          min -0.00667865  max 1.66322
  -- Solve :
          min -0.00667865  max 1.66322
pT min and max: -0.0677103, 5.28185e-032
  -- Solve :
          min -0.0518746  max 5.18339e-034
  14 1.8041377e-003 0.00e+000 7.95e-006 -11.0 2.22e-003    -  1.00e+000 1.00e+000w  1
 
Number of Iterations....: 14
 
                                   (scaled)                 (unscaled)
Objective...............:  1.8041376617303193e-003   1.8041376617303193e-003
Dual infeasibility......:  7.9460032028286220e-006   7.9460032028286220e-006
Constraint violation....:  0.0000000000000000e+000   0.0000000000000000e+000
Complementarity.........:  0.0000000000000000e+000   0.0000000000000000e+000
Overall NLP error.......:  7.9460032028286220e-006   7.9460032028286220e-006
 
 
Number of objective function evaluations             = 425
Number of objective gradient evaluations             = 15
Number of equality constraint evaluations            = 0
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 0
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 0
Total CPU secs in IPOPT (w/o function evaluations)   =      0.558
Total CPU secs in NLP function evaluations           =     22.917
 
EXIT: Optimal Solution Found.
 
 
*** Ipopt succeeded
(ffe - fh) min and max: -0.0484903, 1
times: compile 0.908s, execution 23.856s,  mpirank:0
 try getConsole D:\Study\HUST\FEM\heatsource\FreeFem++\test2.edp
