-- FreeFem++ v  3.610001 (date jeu. 12 juil. 2018 15:05:23)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : load "ff-IpOpt"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\ff-IpOpt = 0)
    2 : load "medit"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\medit = 0)
    3 :
    4 : real T = 1;
    5 : int nn = 50;
    6 : int Nx = nn, Ny = nn;
    7 : int[int] labs = [1, 2, 0, 4];
    8 : mesh Th = square(Nx, Ny, [x, T * y], label = labs);
    9 : fespace Vh(Th, P1);
   10 :
   11 : Vh ue = sin(pi * x) * sin(pi * y);
   12 : Vh uN = pi * cos(pi * x) * sin(pi * y);
   13 : Vh u0 = ue(x, 0);
   14 : Vh a = 1;
   15 : Vh q = x * y + 1;
   16 : Vh fe = (1 + y^0) * (x * (x <= 0.5) + (1 - x) * (x > 0.5));
   17 : Vh g = pi * sin(pi * x) * cos(pi * y) + a * pi^2 * sin(pi * x) * sin(pi * y) - fe * q;
   18 : real gamma = 1e-6;
   19 :
   20 : // State equation:
   21 : func real[int] StateProblem(real[int] f){
   22 :     Vh u, v, ff; ff[] = f;
   23 :     Vh rsh = ff * q + g;
   24 :
   25 :     solve SpaceTime(u, v, solver = sparsesolver) =
   26 :           int2d(Th)(dy(u)  * v + a * dx(u)  * dx(v))
   27 :         + int2d(Th)(dy(u0) * v + a * dx(u0) * dx(v))
   28 :         - int1d(Th, 2) (uN * v) + int1d(Th, 4) (uN * v)
   29 :         - int2d(Th)(rsh * v)
   30 :         + on(1, u = 0);
   31 :
   32 :     u = u + u0;
   33 :     return u[];
   34 : }
   35 :
   36 :
   37 : func real[int] flip(real[int] u){
   38 :     Vh uu;
   39 :     for (int i =0; i <= Ny/2; i++){
   40 :         for (int j=0; j <= Nx; j++){
   41 :             uu[][i * (Nx + 1) + j] = u[(Ny - i) * (Nx + 1) + j];
   42 :             uu[][(Ny - i) * (Nx + 1) + j] = u[i * (Nx + 1) + j];
   43 :         }
   44 :     }
   45 :     return uu[];
   46 : }
   47 :
   48 :
   49 : // Adjoint equation
   50 : func real[int] AdjointProblem(real[int] u){
   51 :     Vh p, v, uu; uu[] = u;
   52 :     Vh temp = uu - ue;
   53 :     Vh rsh =  flip(temp[]);
   54 :     Vh pN = 0;
   55 :
   56 :     solve SpaceTime(p, v, solver = sparsesolver) =
   57 :           int2d(Th)(dy(p) * v + a(x, T-y) * dx(p) * dx(v))
   58 :         - int1d(Th, 2, 4)(pN * v)
   59 :         - int2d(Th)(rsh * v) + on(1, p = 0);
   60 :
   61 :     return flip(p[]);
   62 : }
   63 :
   64 :
   65 : // Tikhonov functional
   66 : func real J(real[int] f) {
   67 :     Vh ff; ff[] = f;
   68 :     Vh uu; uu[] = StateProblem(f);
   69 :     return 0.5 * int2d(Th)((uu - ue)^2) + 0.5 * gamma * int2d(Th)(ff^2);
   70 : }
   71 :
   72 :
   73 : // Gradient of Tikhonov funtional
   74 : func real[int] GradJ(real[int] f) {
   75 :     Vh ff; ff[] = f;
   76 :     Vh p; p[] = AdjointProblem(StateProblem(f));
   77 :     Vh res = p * q + gamma * ff;
   78 :     return res[];
   79 : }
   80 :
   81 : Vh f = 0;
   82 : IPOPT(J, GradJ, f[], tol = 1e-4);
   83 :
   84 : //savemesh(Th, "IP1.mesh");
   85 : //savesol("IP1.sol", Th, f);
   86 : //savemesh(Th, "IPe.mesh");
   87 : //savesol("IPe.sol", Th, fe);
   88 :
   89 : Vh u; u[] = StateProblem(f[]);
   90 :
   91 : plot(ue, wait = 1, dim=3d);
   92 : plot(u, wait = 1, dim=3d);
   93 : plot(u, ue, wait = 1, dim=3d);
   94 :
   95 : plot(fe, wait = 1, dim=3d);
   96 : plot(f, wait = 1, dim=3d);
   97 : plot(f, fe, wait = 1, dim=3d);
   98 : cout << "Error: " << sqrt(int2d(Th)((fe - f)^2)) << endl;
   99 :  sizestack + 1024 =10176  ( 9152 )
 
  -- Square mesh : nb vertices  =2601 ,  nb triangles = 5000 ,  nb boundary edges 200
 
IPOPT Note : No hessian given ==> LBFGS hessian approximation enabled
 
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************
 
This is Ipopt version 3.12.4, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).
 
Number of nonzeros in equality constraint Jacobian...:        0
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0
 
  -- Solve :
          min -0.640547  max 0.724712
  -- Solve :
          min -0.292457  max 1.26332e-034
Total number of variables............................:     2601
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:        0
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0
 
  -- Solve :
          min -0.640547  max 0.724712
  -- Solve :
          min -0.292457  max 1.26332e-034
  -- Solve :
          min -0.640547  max 0.724712
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 5.9180228e-002 0.00e+000 3.51e-001   0.0 0.00e+000    -  0.00e+000 0.00e+000   0
  -- Solve :
          min -0.352703  max 0.879297
  -- Solve :
          min -0.352703  max 0.879297
  -- Solve :
          min -0.129347  max 6.82552e-035
   1 1.2602472e-002 0.00e+000 1.56e-001 -11.0 3.51e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.107692  max 1.01396
  -- Solve :
          min -0.107692  max 1.01396
  -- Solve :
          min -0.00833267  max 0.00581966
   2 4.3148890e-004 0.00e+000 1.17e-002 -11.0 2.83e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.101373  max 1.01087
  -- Solve :
          min -0.101373  max 1.01087
  -- Solve :
          min -0.00744645  max 0.00538714
   3 3.6428228e-004 0.00e+000 1.01e-002 -11.0 2.22e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0522104  max 0.984898
  -- Solve :
          min -0.0522104  max 0.984898
  -- Solve :
          min -0.00180172  max 0.00228431
   4 8.4092385e-005 0.00e+000 3.72e-003 -11.0 2.10e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0435543  max 0.984928
  -- Solve :
          min -0.0435543  max 0.984928
  -- Solve :
          min -0.00119911  max 0.00181517
   5 5.7910385e-005 0.00e+000 3.09e-003 -11.0 6.89e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0297998  max 0.989092
  -- Solve :
          min -0.0297998  max 0.989092
  -- Solve :
          min -0.000492478  max 0.00106847
   6 3.1560216e-005 0.00e+000 1.13e-003 -11.0 1.87e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0230758  max 0.991373
  -- Solve :
          min -0.0230758  max 0.991373
  -- Solve :
          min -0.000263691  max 0.00119292
   7 2.3768640e-005 0.00e+000 1.30e-003 -11.0 1.18e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0411804  max 0.99524
  -- Solve :
          min -0.0411804  max 0.99524
  -- Solve :
          min -0.0411804  max 0.99524
  -- Solve :
          min -0.0411804  max 0.99524
  -- Solve :
          min -0.0411804  max 0.99524
  -- Solve :
          min -0.0204957  max 0.991959
  -- Solve :
          min -0.0217453  max 0.990318
  -- Solve :
          min -0.0217453  max 0.990318
  -- Solve :
          min -0.00352046  max 0.000423882
   8 2.0000625e-005 0.00e+000 3.62e-003 -11.0 6.23e-001    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -0.664328  max 1.37657
  -- Solve :
          min -0.664328  max 1.37657
  -- Solve :
          min -0.664328  max 1.37657
  -- Solve :
          min -0.664328  max 1.37657
  -- Solve :
          min -0.664328  max 1.37657
  -- Solve :
          min -0.33133  max 1.17025
  -- Solve :
          min -0.164831  max 1.07679
  -- Solve :
          min -0.081581  max 1.03355
  -- Solve :
          min -0.0399562  max 1.01193
  -- Solve :
          min -0.0207161  max 1.00113
  -- Solve :
          min -0.0154631  max 0.995722
  -- Solve :
          min -0.0185702  max 0.99302
  -- Solve :
          min -0.0201578  max 0.991669
  -- Solve :
          min -0.0201578  max 0.991669
  -- Solve :
          min -0.00395761  max 0.000520226
   9 1.9855468e-005 0.00e+000 4.12e-003 -11.0 1.07e+001    -  1.00e+000 3.91e-003f  9
  -- Solve :
          min -0.0820135  max 1.0721
  -- Solve :
          min -0.0820135  max 1.0721
  -- Solve :
          min -0.0820135  max 1.0721
  -- Solve :
          min -0.0820135  max 1.0721
  -- Solve :
          min -0.0820135  max 1.0721
  -- Solve :
          min -0.0407438  max 1.02929
  -- Solve :
          min -0.0215157  max 1.00822
  -- Solve :
          min -0.0122758  max 0.999283
  -- Solve :
          min -0.0122758  max 0.999283
  -- Solve :
          min -0.000829283  max 0.0021344
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 1.4384969e-005 0.00e+000 2.30e-003 -11.0 2.17e+000    -  1.00e+000 1.25e-001f  4
  -- Solve :
          min -0.019021  max 1.01975
  -- Solve :
          min -0.019021  max 1.01975
  -- Solve :
          min -0.019021  max 1.01975
  -- Solve :
          min -0.019021  max 1.01975
  -- Solve :
          min -0.019021  max 1.01975
  -- Solve :
          min -0.0144062  max 1.00872
  -- Solve :
          min -0.0126464  max 1.0032
  -- Solve :
          min -0.0126464  max 1.0032
  -- Solve :
          min -0.000545943  max 0.00278761
  11 1.1689027e-005 0.00e+000 3.28e-003 -11.0 3.99e-001    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -0.0513805  max 1.00388
  -- Solve :
          min -0.0513805  max 1.00388
  -- Solve :
          min -0.0513805  max 1.00388
  -- Solve :
          min -0.0513805  max 1.00388
  -- Solve :
          min -0.0513805  max 1.00388
  -- Solve :
          min -0.0234129  max 1.00354
  -- Solve :
          min -0.00949269  max 1.00337
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -1.74093e-036  max 0.0023848
  12 8.4096138e-006 0.00e+000 2.85e-003 -11.0 9.70e-001    -  1.00e+000 1.25e-001f  4
  -- Solve :
          min -0.0134329  max 1.02945
  -- Solve :
          min -0.0134329  max 1.02945
  -- Solve :
          min -0.0134329  max 1.02945
  -- Solve :
          min -0.0134329  max 1.02945
  -- Solve :
          min -0.0134329  max 1.02945
  -- Solve :
          min -0.00661597  max 1.01637
  -- Solve :
          min -0.00803928  max 1.00983
  -- Solve :
          min -0.00875093  max 1.00655
  -- Solve :
          min -0.00910676  max 1.00492
  -- Solve :
          min -0.00928468  max 1.0041
  -- Solve :
          min -0.00937363  max 1.00369
  -- Solve :
          min -0.00941811  max 1.00349
  -- Solve :
          min -0.00944035  max 1.00339
  -- Solve :
          min -0.00945147  max 1.00333
  -- Solve :
          min -0.00945703  max 1.00331
  -- Solve :
          min -0.00945981  max 1.0033
  -- Solve :
          min -0.0094612  max 1.00329
  -- Solve :
          min -0.0094619  max 1.00329
  -- Solve :
          min -0.00946224  max 1.00329
  -- Solve :
          min -0.00946242  max 1.00328
  -- Solve :
          min -0.0094625  max 1.00328
  -- Solve :
          min -0.00946255  max 1.00328
  -- Solve :
          min -0.00946257  max 1.00328
  -- Solve :
          min -0.00946258  max 1.00328
  -- Solve :
          min -0.00946258  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -0.00946259  max 1.00328
  -- Solve :
          min -1.74093e-036  max 0.0023848
  13 8.4096138e-006 0.00e+000 2.85e-003 -11.0 3.20e-001    -  1.00e+000 4.55e-013f 42
  -- Solve :
          min -0.0251038  max 1.03087
  -- Solve :
          min -0.0251038  max 1.03087
  -- Solve :
          min -0.0251038  max 1.03087
  -- Solve :
          min -0.0251038  max 1.03087
  -- Solve :
          min -0.0251038  max 1.03087
  -- Solve :
          min -0.0102655  max 1.01708
  -- Solve :
          min -0.0047645  max 1.01018
  -- Solve :
          min -0.00690029  max 1.00673
  -- Solve :
          min -0.00818144  max 1.00501
  -- Solve :
          min -0.00882202  max 1.00415
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -3.12043e-036  max 0.00261729
  14 8.4008529e-006 0.00e+000 3.04e-003 -11.0 5.16e-001    -  1.00e+000 1.56e-002f  7
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -1.40035  max 2.91235
  -- Solve :
          min -0.700638  max 1.95705
  -- Solve :
          min -0.350785  max 1.47939
  -- Solve :
          min -0.175858  max 1.24116
  -- Solve :
          min -0.0883946  max 1.12244
  -- Solve :
          min -0.044663  max 1.06308
  -- Solve :
          min -0.0266857  max 1.0334
  -- Solve :
          min -0.017914  max 1.01855
  -- Solve :
          min -0.0135282  max 1.01113
  -- Solve :
          min -0.0113352  max 1.00742
  -- Solve :
          min -0.0102388  max 1.00557
  -- Solve :
          min -0.00969053  max 1.00464
  -- Solve :
          min -0.00941642  max 1.00418
  -- Solve :
          min -0.00927936  max 1.00395
  -- Solve :
          min -0.00921083  max 1.00383
  -- Solve :
          min -0.00917657  max 1.00377
  -- Solve :
          min -0.00915944  max 1.00374
  -- Solve :
          min -0.00915087  max 1.00373
  -- Solve :
          min -0.00914659  max 1.00372
  -- Solve :
          min -0.00914444  max 1.00372
  -- Solve :
          min -0.00914337  max 1.00372
  -- Solve :
          min -0.00914284  max 1.00372
  -- Solve :
          min -0.00914257  max 1.00372
  -- Solve :
          min -0.00914244  max 1.00371
  -- Solve :
          min -0.00914237  max 1.00371
  -- Solve :
          min -0.00914234  max 1.00371
  -- Solve :
          min -0.00914232  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -3.12043e-036  max 0.00261729
  15 8.4008529e-006 0.00e+000 3.04e-003 -11.0 4.85e+001    -  1.00e+000 4.34e-019f 62
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -1.40035  max 2.91235
  -- Solve :
          min -0.700638  max 1.95705
  -- Solve :
          min -0.350785  max 1.47939
  -- Solve :
          min -0.175858  max 1.24116
  -- Solve :
          min -0.0883946  max 1.12244
  -- Solve :
          min -0.044663  max 1.06308
  -- Solve :
          min -0.0266857  max 1.0334
  -- Solve :
          min -0.017914  max 1.01855
  -- Solve :
          min -0.0135282  max 1.01113
  -- Solve :
          min -0.0113352  max 1.00742
  -- Solve :
          min -0.0102388  max 1.00557
  -- Solve :
          min -0.00969053  max 1.00464
  -- Solve :
          min -0.00941642  max 1.00418
  -- Solve :
          min -0.00927936  max 1.00395
  -- Solve :
          min -0.00921083  max 1.00383
  -- Solve :
          min -0.00917657  max 1.00377
  -- Solve :
          min -0.00915944  max 1.00374
  -- Solve :
          min -0.00915087  max 1.00373
  -- Solve :
          min -0.00914659  max 1.00372
  -- Solve :
          min -0.00914444  max 1.00372
  -- Solve :
          min -0.00914337  max 1.00372
  -- Solve :
          min -0.00914284  max 1.00372
  -- Solve :
          min -0.00914257  max 1.00372
  -- Solve :
          min -0.00914244  max 1.00371
  -- Solve :
          min -0.00914237  max 1.00371
  -- Solve :
          min -0.00914234  max 1.00371
  -- Solve :
          min -0.00914232  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -3.12043e-036  max 0.00261729
  16 8.4008529e-006 0.00e+000 3.04e-003 -11.0 4.85e+001    -  1.00e+000 1.08e-019f 64
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -2.79976  max 5.02488
  -- Solve :
          min -1.40035  max 2.91235
  -- Solve :
          min -0.700638  max 1.95705
  -- Solve :
          min -0.350785  max 1.47939
  -- Solve :
          min -0.175858  max 1.24116
  -- Solve :
          min -0.0883946  max 1.12244
  -- Solve :
          min -0.044663  max 1.06308
  -- Solve :
          min -0.0266857  max 1.0334
  -- Solve :
          min -0.017914  max 1.01855
  -- Solve :
          min -0.0135282  max 1.01113
  -- Solve :
          min -0.0113352  max 1.00742
  -- Solve :
          min -0.0102388  max 1.00557
  -- Solve :
          min -0.00969053  max 1.00464
  -- Solve :
          min -0.00941642  max 1.00418
  -- Solve :
          min -0.00927936  max 1.00395
  -- Solve :
          min -0.00921083  max 1.00383
  -- Solve :
          min -0.00917657  max 1.00377
  -- Solve :
          min -0.00915944  max 1.00374
  -- Solve :
          min -0.00915087  max 1.00373
  -- Solve :
          min -0.00914659  max 1.00372
  -- Solve :
          min -0.00914444  max 1.00372
  -- Solve :
          min -0.00914337  max 1.00372
  -- Solve :
          min -0.00914284  max 1.00372
  -- Solve :
          min -0.00914257  max 1.00372
  -- Solve :
          min -0.00914244  max 1.00371
  -- Solve :
          min -0.00914237  max 1.00371
  -- Solve :
          min -0.00914234  max 1.00371
  -- Solve :
          min -0.00914232  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.00914231  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -0.0091423  max 1.00371
  -- Solve :
          min -3.12043e-036  max 0.00261729
  17 8.4008529e-006 0.00e+000 3.04e-003 -11.0 4.85e+001    -  1.00e+000 2.71e-020f 66
  -- Solve :
          min -0.0115787  max 1.00222
  -- Solve :
          min -0.0115787  max 1.00222
  -- Solve :
          min -2.63019e-036  max 0.00120988
  18 5.0370206e-006 0.00e+000 1.37e-003 -11.0 3.04e-003    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0135656  max 1.00095
  -- Solve :
          min -0.0135656  max 1.00095
  -- Solve :
          min -0.000303081  max 0.000516667
  19 4.1407854e-006 0.00e+000 6.80e-004 -11.0 2.56e-003    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0135633  max 1.00089
  -- Solve :
          min -0.0135633  max 1.00089
  -- Solve :
          min -0.000327606  max 0.000502669
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 4.0689618e-006 0.00e+000 6.62e-004 -11.0 1.51e-003    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0106225  max 0.999918
  -- Solve :
          min -0.0106225  max 0.999918
  -- Solve :
          min -0.000604226  max 0.000192318
  21 2.3473997e-006 0.00e+000 6.18e-004 -11.0 6.11e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0105195  max 1.00111
  -- Solve :
          min -0.0105195  max 1.00111
  -- Solve :
          min -0.000269498  max 0.000457658
  22 1.4154870e-006 0.00e+000 4.67e-004 -11.0 6.76e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.0447263  max 0.991708
  -- Solve :
          min -0.0447263  max 0.991708
  -- Solve :
          min -0.0447263  max 0.991708
  -- Solve :
          min -0.0447263  max 0.991708
  -- Solve :
          min -0.0447263  max 0.991708
  -- Solve :
          min -0.0270745  max 0.995023
  -- Solve :
          min -0.0182486  max 0.99668
  -- Solve :
          min -0.0140285  max 0.998442
  -- Solve :
          min -0.0119877  max 0.999778
  -- Solve :
          min -0.0119877  max 0.999778
  -- Solve :
          min -0.000408474  max 6.97028e-037
  23 1.1822437e-006 0.00e+000 4.41e-004 -11.0 6.67e-001    -  1.00e+000 6.25e-002f  5
  -- Solve :
          min -0.0114119  max 1.00033
  -- Solve :
          min -0.0114119  max 1.00033
  -- Solve :
          min -6.27286e-005  max 0.000292081
  24 9.0567960e-007 0.00e+000 4.30e-004 -11.0 3.06e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.015304  max 1.00038
  -- Solve :
          min -0.015304  max 1.00038
  -- Solve :
          min -0.015304  max 1.00038
  -- Solve :
          min -0.015304  max 1.00038
  -- Solve :
          min -0.015304  max 1.00038
  -- Solve :
          min -0.0133242  max 1.00036
  -- Solve :
          min -0.0123607  max 1.00034
  -- Solve :
          min -0.0123607  max 1.00034
  -- Solve :
          min -0.000176351  max 8.90434e-005
  25 8.3561961e-007 0.00e+000 2.71e-004 -11.0 5.72e-002    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -0.0109171  max 1.0028
  -- Solve :
          min -0.0109171  max 1.0028
  -- Solve :
          min -0.0109171  max 1.0028
  -- Solve :
          min -0.0109171  max 1.0028
  -- Solve :
          min -0.0109171  max 1.0028
  -- Solve :
          min -0.0116389  max 1.00157
  -- Solve :
          min -0.0119998  max 1.00096
  -- Solve :
          min -0.0119998  max 1.00096
  -- Solve :
          min -3.60114e-005  max 0.000391592
  26 7.7880842e-007 0.00e+000 4.02e-004 -11.0 1.12e-001    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -0.01228  max 0.997534
  -- Solve :
          min -0.01228  max 0.997534
  -- Solve :
          min -0.01228  max 0.997534
  -- Solve :
          min -0.01228  max 0.997534
  -- Solve :
          min -0.01228  max 0.997534
  -- Solve :
          min -0.0121399  max 0.997924
  -- Solve :
          min -0.0120699  max 0.998617
  -- Solve :
          min -0.0120348  max 0.999787
  -- Solve :
          min -0.0120348  max 0.999787
  -- Solve :
          min -0.000264458  max 4.81271e-005
  27 7.0493030e-007 0.00e+000 3.63e-004 -11.0 1.07e-001    -  1.00e+000 1.25e-001f  4
  -- Solve :
          min -0.0125887  max 1.00006
  -- Solve :
          min -0.0125887  max 1.00006
  -- Solve :
          min -0.0125887  max 1.00006
  -- Solve :
          min -0.0125887  max 1.00006
  -- Solve :
          min -0.0125887  max 1.00006
  -- Solve :
          min -0.0123118  max 0.999921
  -- Solve :
          min -0.0123118  max 0.999921
  -- Solve :
          min -0.000161355  max 4.33754e-005
  28 6.3370730e-007 0.00e+000 1.70e-004 -11.0 5.17e-002    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -0.0299981  max 1.01268
  -- Solve :
          min -0.0299981  max 1.01268
  -- Solve :
          min -0.0299981  max 1.01268
  -- Solve :
          min -0.0299981  max 1.01268
  -- Solve :
          min -0.0299981  max 1.01268
  -- Solve :
          min -0.014817  max 1.0063
  -- Solve :
          min -0.0100583  max 1.00311
  -- Solve :
          min -0.0108835  max 1.00152
  -- Solve :
          min -0.011469  max 1.00072
  -- Solve :
          min -0.0118904  max 1.00032
  -- Solve :
          min -0.0118904  max 1.00032
  -- Solve :
          min -9.24527e-005  max 0.000176164
  29 6.1964360e-007 0.00e+000 2.50e-004 -11.0 4.34e-001    -  1.00e+000 3.12e-002f  6
  -- Solve :
          min -0.0130922  max 0.999511
  -- Solve :
          min -0.0130922  max 0.999511
  -- Solve :
          min -0.0130922  max 0.999511
  -- Solve :
          min -0.0130922  max 0.999511
  -- Solve :
          min -0.0130922  max 0.999511
  -- Solve :
          min -0.0113947  max 0.998742
  -- Solve :
          min -0.0114485  max 0.998839
  -- Solve :
          min -0.0114754  max 0.999579
  -- Solve :
          min -0.0116497  max 0.99995
  -- Solve :
          min -0.0116497  max 0.99995
  -- Solve :
          min -0.000168109  max 1.24986e-005
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 6.0487886e-007 0.00e+000 2.17e-004 -11.0 1.73e-001    -  1.00e+000 6.25e-002f  5
  -- Solve :
          min -0.0120041  max 1.00014
  -- Solve :
          min -0.0120041  max 1.00014
  -- Solve :
          min -0.0120041  max 1.00014
  -- Solve :
          min -0.0120041  max 1.00014
  -- Solve :
          min -0.0120041  max 1.00014
  -- Solve :
          min -0.0117697  max 1.00004
  -- Solve :
          min -0.0117697  max 1.00004
  -- Solve :
          min -9.15066e-005  max 0.000123906
  31 5.5236168e-007 0.00e+000 1.34e-004 -11.0 5.14e-002    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -0.0494064  max 0.991001
  -- Solve :
          min -0.0494064  max 0.991001
  -- Solve :
          min -0.0494064  max 0.991001
  -- Solve :
          min -0.0494064  max 0.991001
  -- Solve :
          min -0.0494064  max 0.991001
  -- Solve :
          min -0.0238103  max 0.994418
  -- Solve :
          min -0.0113796  max 0.996126
  -- Solve :
          min -0.00991222  max 0.99698
  -- Solve :
          min -0.0108293  max 0.997466
  -- Solve :
          min -0.0112879  max 0.998754
  -- Solve :
          min -0.0115172  max 0.999399
  -- Solve :
          min -0.0115172  max 0.999399
  -- Solve :
          min -0.000220183  max 4.80531e-006
  32 5.3605808e-007 0.00e+000 2.93e-004 -11.0 5.04e-001    -  1.00e+000 1.56e-002f  7
  -- Solve :
          min -0.0144074  max 1.00312
  -- Solve :
          min -0.0144074  max 1.00312
  -- Solve :
          min -0.0144074  max 1.00312
  -- Solve :
          min -0.0144074  max 1.00312
  -- Solve :
          min -0.0144074  max 1.00312
  -- Solve :
          min -0.0129339  max 1.00126
  -- Solve :
          min -0.0121971  max 1.00033
  -- Solve :
          min -0.0118287  max 0.999864
  -- Solve :
          min -0.0118287  max 0.999864
  -- Solve :
          min -4.96538e-005  max 6.65426e-005
  33 5.2864580e-007 0.00e+000 9.71e-005 -11.0 6.15e-002    -  1.00e+000 1.25e-001f  4
 
Number of Iterations....: 33
 
                                   (scaled)                 (unscaled)
Objective...............:  5.2864579829651533e-007   5.2864579829651533e-007
Dual infeasibility......:  9.7069791822668890e-005   9.7069791822668890e-005
Constraint violation....:  0.0000000000000000e+000   0.0000000000000000e+000
Complementarity.........:  0.0000000000000000e+000   0.0000000000000000e+000
Overall NLP error.......:  9.7069791822668890e-005   9.7069791822668890e-005
 
 
Number of objective function evaluations             = 399
Number of objective gradient evaluations             = 34
Number of equality constraint evaluations            = 0
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 0
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 0
Total CPU secs in IPOPT (w/o function evaluations)   =      1.750
Total CPU secs in NLP function evaluations           =     38.067
 
EXIT: Optimal Solution Found.
 
 
*** Ipopt succeeded
  -- Solve :
          min -0.0118287  max 0.999864
Error: 0.0667549
times: compile 0.261s, execution 46.868s,  mpirank:0
 ######## We forget of deleting   12749 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3476,  size :412536 mpirank: 0
Ok: Normal End
 try getConsole D:\Study\HUST\FEM\heatsource\FreeFem++\HeatSource1D_Q.edp
