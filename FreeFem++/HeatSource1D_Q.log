-- FreeFem++ v  3.610001 (date jeu. 12 juil. 2018 15:05:23)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : load "ff-IpOpt"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\ff-IpOpt = 0)
    2 : load "medit"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\medit = 0)
    3 :
    4 : real T = 1;
    5 : int nn = 50;
    6 : int Nx = nn, Ny = nn;
    7 : int[int] labs = [1, 2, 0, 4];
    8 : mesh Th = square(Nx, Ny, [x, T * y], label = labs);
    9 : fespace Vh(Th, P1);
   10 :
   11 : //func real ue(real x, real y){return cos(pi * x) * sin(pi * y);}
   12 : Vh ue = cos(pi * x) * sin(pi * y);
   13 : Vh uN = 0;
   14 : Vh u0 = 0;
   15 : Vh a = 1;
   16 : Vh q = x * y + 1;
   17 : Vh fe = (1 + y^2) * (x * (x <= 0.5) + (1 - x) * (x > 0.5));
   18 : Vh g = pi * cos(pi * x) * cos(pi * y) + a * pi^2 * cos(pi * x) * sin(pi * y) - fe * q;
   19 : real gamma = 1e-6;
   20 :
   21 : Vh u;
   22 :
   23 : /*
   24 : State equation:
   25 :     u_t - div(a*grad(u)) = f * q + g, (x, t) \in \Omega x [0, T]
   26 : Neumann boundary condition:
   27 :     du(x, t)/dN = uN(x, t), (x, t) \in \partial\Omega x [0, T]
   28 : Initial condition:
   29 :     u(x, 0) = u0(x), x \in \Omega
   30 : */
   31 :
   32 : // State equation:
   33 : func real[int] StateProblem(real[int] f){
   34 :     Vh u, v, ff; ff[] = f;
   35 :     Vh rsh = ff * q + g;
   36 :
   37 :     solve SpaceTime(u, v, solver = sparsesolver) =
   38 :           int2d(Th)(dy(u)  * v + a * dx(u)  * dx(v))
   39 :         + int2d(Th)(dy(u0) * v + a * dx(u0) * dx(v))
   40 :         - int1d(Th, 2, 4) (uN * v)
   41 :         - int2d(Th)(rsh * v)
   42 :         + on(1, u = u0);
   43 :     u = u + u0;
   44 :     return u[];
   45 : }
   46 :
   47 : func real[int] flip(real[int] u){
   48 :     Vh uu; uu[] = u;
   49 :     Vh flipu;
   50 :     for (int i =0; i <= Ny/2; i++){
   51 :         for (int j=0; j <= Nx; j++){
   52 :             flipu[][i * (Nx + 1) + j] = uu[][(Ny - i) * (Nx + 1) + j];
   53 :             flipu[][(Ny - i) * (Nx + 1) + j] = uu[][i * (Nx + 1) + j];
   54 :         }
   55 :     }
   56 :     return flipu[];
   57 : }
   58 : // Adjoint equation
   59 : func real[int] AdjointProblem(real[int] u){
   60 :     Vh p, v, uu; uu[] = u;
   61 :     Vh temp = flip(u);
   62 :     Vh rsh =  temp - ue(x, T - y);
   63 :     Vh pN = 0;
   64 :
   65 :     solve JointProblem(p, v, solver = sparsesolver) =
   66 :           int2d(Th)(dy(p) * v + a(x, T-y) * dx(p) * dx(v))
   67 :         - int1d(Th, 2, 4)(pN * v)
   68 :         - int2d(Th)(rsh * v) + on(1, p = 0);
   69 :     real[int] pp = p[];
   70 :     Vh res = flip(pp);
   71 :     return res[];
   72 : }
   73 :
   74 : // Tikhonov functional
   75 : func real J(real[int] f) {
   76 :     Vh ff; ff[] = f;
   77 :     Vh uu; uu[] = StateProblem(f);
   78 :      return 0.5 * int2d(Th)((uu - ue)^2) + 0.5 * gamma * int2d(Th)(ff^2);
   79 : }
   80 :
   81 : // Gradient of Tikhonov funtional
   82 : func real[int] GradJ(real[int] f) {
   83 :     Vh ff; ff[] = f;
   84 :     Vh pp; pp[] = AdjointProblem(StateProblem(f));
   85 :     Vh res = pp * q + gamma * ff;
   86 :     return res[];
   87 : }
   88 :
   89 : Vh f = 0;
   90 : IPOPT(J, GradJ, f[], tol=1e-4);
   91 :
   92 : savemesh(Th, "IP1.mesh");
   93 : savesol("IP1.sol", Th, f);
   94 : savemesh(Th, "IPe.mesh");
   95 : savesol("IPe.sol", Th, fe);
   96 :
   97 : plot(fe, wait = 1, dim=3d);
   98 : plot(f, fe, wait = 1, dim=3d);
   99 : cout << "Error: " << sqrt(int2d(Th)((fe - f)^2)) << endl;
  100 :  sizestack + 1024 =9608  ( 8584 )
 
  -- Square mesh : nb vertices  =2601 ,  nb triangles = 5000 ,  nb boundary edges 200
 
IPOPT Note : No hessian given ==> LBFGS hessian approximation enabled
 
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************
 
This is Ipopt version 3.12.4, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).
 
Number of nonzeros in equality constraint Jacobian...:        0
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:        0
 
  -- Solve :
          min -1.15533  max 0.862482
  -- Solve :
          min -0.173446  max 8.62945e-035
Total number of variables............................:     2601
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:        0
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0
 
  -- Solve :
          min -1.15533  max 0.862482
  -- Solve :
          min -0.173446  max 8.62945e-035
  -- Solve :
          min -1.15533  max 0.862482
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 2.2306771e-002 0.00e+000 2.12e-001   0.0 0.00e+000    -  0.00e+000 0.00e+000   0
  -- Solve :
          min -1.03986  max 0.953821
  -- Solve :
          min -1.03986  max 0.953821
  -- Solve :
          min -0.0746633  max 5.0616e-035
   1 5.0551909e-003 0.00e+000 9.49e-002 -11.0 2.12e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.95261  max 1.02893
  -- Solve :
          min -0.95261  max 1.02893
  -- Solve :
          min -0.00851571  max 0.00696566
   2 4.4745215e-004 0.00e+000 1.31e-002 -11.0 1.76e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.956168  max 1.02581
  -- Solve :
          min -0.956168  max 1.02581
  -- Solve :
          min -0.00739288  max 0.00669971
   3 3.6404466e-004 0.00e+000 1.10e-002 -11.0 2.64e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.989453  max 1.00033
  -- Solve :
          min -0.989453  max 1.00033
  -- Solve :
          min -0.00183384  max 0.00205968
   4 6.1564241e-005 0.00e+000 3.34e-003 -11.0 2.00e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.992034  max 1.00167
  -- Solve :
          min -0.992034  max 1.00167
  -- Solve :
          min -0.00133269  max 0.0016067
   5 4.1167749e-005 0.00e+000 2.71e-003 -11.0 5.69e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.993878  max 1.00691
  -- Solve :
          min -0.993878  max 1.00691
  -- Solve :
          min -0.000515049  max 0.000796645
   6 1.6874597e-005 0.00e+000 1.02e-003 -11.0 1.78e-001    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -0.993955  max 1.00622
  -- Solve :
          min -0.993955  max 1.00622
  -- Solve :
          min -0.000347393  max 0.000648052
   7 1.2170836e-005 0.00e+000 8.30e-004 -11.0 9.83e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -1.00772  max 1.00375
  -- Solve :
          min -1.00772  max 1.00375
  -- Solve :
          min -1.00772  max 1.00375
  -- Solve :
          min -1.00772  max 1.00375
  -- Solve :
          min -1.00772  max 1.00375
  -- Solve :
          min -1.00084  max 1.00392
  -- Solve :
          min -1.00084  max 1.00392
  -- Solve :
          min -0.00321402  max 0.000250186
   8 1.0861725e-005 0.00e+000 3.24e-003 -11.0 3.78e-001    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -1.3162  max 1.22372
  -- Solve :
          min -1.3162  max 1.22372
  -- Solve :
          min -1.3162  max 1.22372
  -- Solve :
          min -1.3162  max 1.22372
  -- Solve :
          min -1.3162  max 1.22372
  -- Solve :
          min -1.15058  max 1.10607
  -- Solve :
          min -1.07189  max 1.05394
  -- Solve :
          min -1.03619  max 1.02893
  -- Solve :
          min -1.01851  max 1.01642
  -- Solve :
          min -1.00967  max 1.01017
  -- Solve :
          min -1.00526  max 1.00704
  -- Solve :
          min -1.00305  max 1.00548
  -- Solve :
          min -1.00194  max 1.0047
  -- Solve :
          min -1.00194  max 1.0047
  -- Solve :
          min -0.00330014  max 0.000394137
   9 1.0678305e-005 0.00e+000 3.40e-003 -11.0 1.65e+001    -  1.00e+000 3.91e-003f  9
  -- Solve :
          min -1.0116  max 1.06207
  -- Solve :
          min -1.0116  max 1.06207
  -- Solve :
          min -1.0116  max 1.06207
  -- Solve :
          min -1.0116  max 1.06207
  -- Solve :
          min -1.0116  max 1.06207
  -- Solve :
          min -1.00343  max 1.0314
  -- Solve :
          min -0.99934  max 1.01607
  -- Solve :
          min -0.998629  max 1.0084
  -- Solve :
          min -1.00029  max 1.00549
  -- Solve :
          min -1.00029  max 1.00549
  -- Solve :
          min -0.000860828  max 0.000999124
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 6.7001563e-006 0.00e+000 1.56e-003 -11.0 2.40e+000    -  1.00e+000 6.25e-002f  5
  -- Solve :
          min -1.00029  max 1.00227
  -- Solve :
          min -1.00029  max 1.00227
  -- Solve :
          min -1.00029  max 1.00227
  -- Solve :
          min -1.00029  max 1.00227
  -- Solve :
          min -1.00029  max 1.00227
  -- Solve :
          min -1.00029  max 1.00347
  -- Solve :
          min -1.00029  max 1.00347
  -- Solve :
          min -0.00110574  max 0.000305855
  11 3.4827591e-006 0.00e+000 2.01e-003 -11.0 2.91e-001    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -1.02137  max 0.97302
  -- Solve :
          min -1.02137  max 0.97302
  -- Solve :
          min -1.02137  max 0.97302
  -- Solve :
          min -1.02137  max 0.97302
  -- Solve :
          min -1.02137  max 0.97302
  -- Solve :
          min -1.01083  max 0.98821
  -- Solve :
          min -1.00556  max 0.995805
  -- Solve :
          min -1.00292  max 0.999602
  -- Solve :
          min -1.00292  max 0.999602
  -- Solve :
          min -0.000889329  max 0.0004988
  12 3.2129912e-006 0.00e+000 1.25e-003 -11.0 5.96e-001    -  1.00e+000 1.25e-001f  4
  -- Solve :
          min -0.995849  max 1.0057
  -- Solve :
          min -0.995849  max 1.0057
  -- Solve :
          min -0.995849  max 1.0057
  -- Solve :
          min -0.995849  max 1.0057
  -- Solve :
          min -0.995849  max 1.0057
  -- Solve :
          min -0.99772  max 1.0021
  -- Solve :
          min -1.00032  max 1.00031
  -- Solve :
          min -1.00032  max 1.00031
  -- Solve :
          min -7.2683e-005  max 0.000730706
  13 2.6066775e-006 0.00e+000 8.43e-004 -11.0 8.30e-002    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -0.994515  max 1.01103
  -- Solve :
          min -0.994515  max 1.01103
  -- Solve :
          min -0.994515  max 1.01103
  -- Solve :
          min -0.994515  max 1.01103
  -- Solve :
          min -0.994515  max 1.01103
  -- Solve :
          min -0.996013  max 1.00567
  -- Solve :
          min -0.996957  max 1.00299
  -- Solve :
          min -0.998513  max 1.00165
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -2.27422e-036  max 0.00111424
  14 2.5698279e-006 0.00e+000 1.22e-003 -11.0 2.08e-001    -  1.00e+000 6.25e-002f  5
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.00781  max 1.0324
  -- Solve :
          min -1.00257  max 1.01669
  -- Solve :
          min -0.999946  max 1.00883
  -- Solve :
          min -0.998811  max 1.0049
  -- Solve :
          min -0.998342  max 1.00294
  -- Solve :
          min -0.998712  max 1.00196
  -- Solve :
          min -0.999065  max 1.00147
  -- Solve :
          min -0.999241  max 1.00122
  -- Solve :
          min -0.999329  max 1.0011
  -- Solve :
          min -0.999373  max 1.00104
  -- Solve :
          min -0.999395  max 1.00101
  -- Solve :
          min -0.999406  max 1.00099
  -- Solve :
          min -0.999411  max 1.00098
  -- Solve :
          min -0.999414  max 1.00098
  -- Solve :
          min -0.999415  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -2.27422e-036  max 0.00111424
  15 2.5698279e-006 0.00e+000 1.22e-003 -11.0 1.32e+000    -  1.00e+000 2.22e-016f 53
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.00781  max 1.0324
  -- Solve :
          min -1.00257  max 1.01669
  -- Solve :
          min -0.999946  max 1.00883
  -- Solve :
          min -0.998811  max 1.0049
  -- Solve :
          min -0.998342  max 1.00294
  -- Solve :
          min -0.998712  max 1.00196
  -- Solve :
          min -0.999065  max 1.00147
  -- Solve :
          min -0.999241  max 1.00122
  -- Solve :
          min -0.999329  max 1.0011
  -- Solve :
          min -0.999373  max 1.00104
  -- Solve :
          min -0.999395  max 1.00101
  -- Solve :
          min -0.999406  max 1.00099
  -- Solve :
          min -0.999411  max 1.00098
  -- Solve :
          min -0.999414  max 1.00098
  -- Solve :
          min -0.999415  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -2.27422e-036  max 0.00111424
  16 2.5698279e-006 0.00e+000 1.22e-003 -11.0 1.32e+000    -  1.00e+000 1.73e-018f 60
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.0183  max 1.06382
  -- Solve :
          min -1.00781  max 1.0324
  -- Solve :
          min -1.00257  max 1.01669
  -- Solve :
          min -0.999946  max 1.00883
  -- Solve :
          min -0.998811  max 1.0049
  -- Solve :
          min -0.998342  max 1.00294
  -- Solve :
          min -0.998712  max 1.00196
  -- Solve :
          min -0.999065  max 1.00147
  -- Solve :
          min -0.999241  max 1.00122
  -- Solve :
          min -0.999329  max 1.0011
  -- Solve :
          min -0.999373  max 1.00104
  -- Solve :
          min -0.999395  max 1.00101
  -- Solve :
          min -0.999406  max 1.00099
  -- Solve :
          min -0.999411  max 1.00098
  -- Solve :
          min -0.999414  max 1.00098
  -- Solve :
          min -0.999415  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999416  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -0.999417  max 1.00098
  -- Solve :
          min -2.27422e-036  max 0.00111424
  17 2.5698279e-006 0.00e+000 1.22e-003 -11.0 1.32e+000    -  1.00e+000 6.94e-018f 58
  -- Solve :
          min -1.00003  max 1.00042
  -- Solve :
          min -1.00003  max 1.00042
  -- Solve :
          min -3.98947e-005  max 0.000560454
  18 2.1001780e-006 0.00e+000 5.88e-004 -11.0 1.22e-003    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -1.00056  max 0.999947
  -- Solve :
          min -1.00056  max 0.999947
  -- Solve :
          min -0.000225424  max 0.000362324
  19 1.9867548e-006 0.00e+000 4.97e-004 -11.0 1.54e-003    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -1.0006  max 0.999902
  -- Solve :
          min -1.0006  max 0.999902
  -- Solve :
          min -0.00024123  max 0.000347979
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20 1.9612573e-006 0.00e+000 4.77e-004 -11.0 1.33e-003    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -1.00056  max 0.999857
  -- Solve :
          min -1.00056  max 0.999857
  -- Solve :
          min -0.00032205  max 0.000194591
  21 1.3703050e-006 0.00e+000 4.58e-004 -11.0 3.54e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -1.00189  max 0.998672
  -- Solve :
          min -1.00189  max 0.998672
  -- Solve :
          min -1.00189  max 0.998672
  -- Solve :
          min -1.00189  max 0.998672
  -- Solve :
          min -1.00189  max 0.998672
  -- Solve :
          min -1.00123  max 0.999264
  -- Solve :
          min -1.00123  max 0.999264
  -- Solve :
          min -0.000685099  max 5.35556e-005
  22 1.0442519e-006 0.00e+000 8.67e-004 -11.0 9.70e-002    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -0.99689  max 1.00319
  -- Solve :
          min -0.99689  max 1.00319
  -- Solve :
          min -0.99689  max 1.00319
  -- Solve :
          min -0.99689  max 1.00319
  -- Solve :
          min -0.99689  max 1.00319
  -- Solve :
          min -0.998866  max 1.00123
  -- Solve :
          min -0.998866  max 1.00123
  -- Solve :
          min -4.84877e-005  max 0.000686111
  23 7.2670154e-007 0.00e+000 7.16e-004 -11.0 8.71e-002    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -1.0011  max 0.998022
  -- Solve :
          min -1.0011  max 0.998022
  -- Solve :
          min -1.0011  max 0.998022
  -- Solve :
          min -1.0011  max 0.998022
  -- Solve :
          min -1.0011  max 0.998022
  -- Solve :
          min -0.999983  max 0.999454
  -- Solve :
          min -0.999425  max 1.00034
  -- Solve :
          min -0.999425  max 1.00034
  -- Solve :
          min -7.99861e-005  max 0.000251636
  24 6.0488693e-007 0.00e+000 3.67e-004 -11.0 9.97e-002    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -1.00016  max 1.0002
  -- Solve :
          min -1.00016  max 1.0002
  -- Solve :
          min -1.00016  max 1.0002
  -- Solve :
          min -1.00016  max 1.0002
  -- Solve :
          min -1.00016  max 1.0002
  -- Solve :
          min -0.999792  max 1.00027
  -- Solve :
          min -0.999792  max 1.00027
  -- Solve :
          min -0.00014824  max 2.03704e-005
  25 5.7591859e-007 0.00e+000 2.14e-004 -11.0 1.12e-002    -  1.00e+000 5.00e-001f  2
  -- Solve :
          min -1.00059  max 0.999996
  -- Solve :
          min -1.00059  max 0.999996
  -- Solve :
          min -0.000216758  max 7.94587e-006
  26 4.9508885e-007 0.00e+000 2.57e-004 -11.0 1.62e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -8.07337e-005  max 1.38357e-005
  27 4.4835552e-007 0.00e+000 1.23e-004 -11.0 1.27e-002    -  1.00e+000 1.00e+000f  1
  -- Solve :
          min -1.03158  max 1.00454
  -- Solve :
          min -1.03158  max 1.00454
  -- Solve :
          min -1.03158  max 1.00454
  -- Solve :
          min -1.03158  max 1.00454
  -- Solve :
          min -1.03158  max 1.00454
  -- Solve :
          min -1.01594  max 1.00146
  -- Solve :
          min -1.00812  max 0.999927
  -- Solve :
          min -1.00421  max 0.999158
  -- Solve :
          min -1.00226  max 0.998773
  -- Solve :
          min -1.00128  max 0.999455
  -- Solve :
          min -1.00079  max 0.999905
  -- Solve :
          min -1.00055  max 1.00013
  -- Solve :
          min -1.00043  max 1.00024
  -- Solve :
          min -1.00037  max 1.0003
  -- Solve :
          min -1.00033  max 1.00033
  -- Solve :
          min -1.00032  max 1.00034
  -- Solve :
          min -1.00031  max 1.00035
  -- Solve :
          min -1.00031  max 1.00035
  -- Solve :
          min -1.00031  max 1.00035
  -- Solve :
          min -1.00031  max 1.00035
  -- Solve :
          min -1.0003  max 1.00035
  -- Solve :
          min -1.0003  max 1.00035
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -1.0003  max 1.00036
  -- Solve :
          min -8.07337e-005  max 1.38357e-005
  28 4.4835552e-007 0.00e+000 1.23e-004 -11.0 3.42e-001    -  1.00e+000 9.09e-013f 41
  -- Solve :
          min -1.00044  max 1.00036
  -- Solve :
          min -1.00044  max 1.00036
  -- Solve :
          min -1.00044  max 1.00036
  -- Solve :
          min -1.00044  max 1.00036
  -- Solve :
          min -1.00044  max 1.00036
  -- Solve :
          min -1.00037  max 1.00036
  -- Solve :
          min -1.00034  max 1.00036
  -- Solve :
          min -1.00034  max 1.00036
  -- Solve :
          min -7.85925e-005  max 2.05777e-005
  29 4.4085120e-007 0.00e+000 1.17e-004 -11.0 6.98e-002    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -0.986323  max 1.01432
  -- Solve :
          min -0.986323  max 1.01432
  -- Solve :
          min -0.986323  max 1.01432
  -- Solve :
          min -0.986323  max 1.01432
  -- Solve :
          min -0.986323  max 1.01432
  -- Solve :
          min -0.992312  max 1.00734
  -- Solve :
          min -0.995307  max 1.00385
  -- Solve :
          min -0.996804  max 1.0021
  -- Solve :
          min -0.998562  max 1.00123
  -- Solve :
          min -0.999451  max 1.00079
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -5.5355e-005  max 0.000118788
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30 4.3437091e-007 0.00e+000 1.19e-004 -11.0 7.92e-001    -  1.00e+000 1.56e-002f  7
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.997253  max 1.00374
  -- Solve :
          min -0.997787  max 1.00216
  -- Solve :
          min -0.998841  max 1.00137
  -- Solve :
          min -0.999368  max 1.00097
  -- Solve :
          min -0.999631  max 1.00077
  -- Solve :
          min -0.999763  max 1.00067
  -- Solve :
          min -0.999829  max 1.00063
  -- Solve :
          min -0.999862  max 1.0006
  -- Solve :
          min -0.999878  max 1.00059
  -- Solve :
          min -0.999887  max 1.00058
  -- Solve :
          min -0.999891  max 1.00058
  -- Solve :
          min -0.999893  max 1.00058
  -- Solve :
          min -0.999894  max 1.00058
  -- Solve :
          min -0.999894  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -5.5355e-005  max 0.000118788
  31 4.3437091e-007 0.00e+000 1.19e-004 -11.0 2.44e-001    -  1.00e+000 2.84e-014f 46
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.997253  max 1.00374
  -- Solve :
          min -0.997787  max 1.00216
  -- Solve :
          min -0.998841  max 1.00137
  -- Solve :
          min -0.999368  max 1.00097
  -- Solve :
          min -0.999631  max 1.00077
  -- Solve :
          min -0.999763  max 1.00067
  -- Solve :
          min -0.999829  max 1.00063
  -- Solve :
          min -0.999862  max 1.0006
  -- Solve :
          min -0.999878  max 1.00059
  -- Solve :
          min -0.999887  max 1.00058
  -- Solve :
          min -0.999891  max 1.00058
  -- Solve :
          min -0.999893  max 1.00058
  -- Solve :
          min -0.999894  max 1.00058
  -- Solve :
          min -0.999894  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -5.5355e-005  max 0.000118788
  32 4.3437091e-007 0.00e+000 1.19e-004 -11.0 2.44e-001    -  1.00e+000 1.42e-014f 47
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.996572  max 1.00691
  -- Solve :
          min -0.997253  max 1.00374
  -- Solve :
          min -0.997787  max 1.00216
  -- Solve :
          min -0.998841  max 1.00137
  -- Solve :
          min -0.999368  max 1.00097
  -- Solve :
          min -0.999631  max 1.00077
  -- Solve :
          min -0.999763  max 1.00067
  -- Solve :
          min -0.999829  max 1.00063
  -- Solve :
          min -0.999862  max 1.0006
  -- Solve :
          min -0.999878  max 1.00059
  -- Solve :
          min -0.999887  max 1.00058
  -- Solve :
          min -0.999891  max 1.00058
  -- Solve :
          min -0.999893  max 1.00058
  -- Solve :
          min -0.999894  max 1.00058
  -- Solve :
          min -0.999894  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -0.999895  max 1.00058
  -- Solve :
          min -5.5355e-005  max 0.000118788
  33 4.3437091e-007 0.00e+000 1.19e-004 -11.0 2.44e-001    -  1.00e+000 2.22e-016f 53
  -- Solve :
          min -0.999949  max 1.00052
  -- Solve :
          min -0.999949  max 1.00052
  -- Solve :
          min -0.999949  max 1.00052
  -- Solve :
          min -0.999949  max 1.00052
  -- Solve :
          min -0.999949  max 1.00052
  -- Solve :
          min -0.999922  max 1.00055
  -- Solve :
          min -0.999908  max 1.00056
  -- Solve :
          min -0.999908  max 1.00056
  -- Solve :
          min -5.70135e-005  max 0.000107857
  34 4.3433001e-007 0.00e+000 1.08e-004 -11.0 1.19e-004    -  1.00e+000 2.50e-001f  3
  -- Solve :
          min -1.00003  max 1.00043
  -- Solve :
          min -1.00003  max 1.00043
  -- Solve :
          min -1.00003  max 1.00043
  -- Solve :
          min -1.00003  max 1.00043
  -- Solve :
          min -1.00003  max 1.00043
  -- Solve :
          min -0.99997  max 1.0005
  -- Solve :
          min -0.99997  max 1.0005
  -- Solve :
          min -6.1941e-005  max 6.17871e-005
  35 4.3396851e-007 0.00e+000 7.09e-005 -11.0 3.26e-004    -  1.00e+000 5.00e-001f  2
 
Number of Iterations....: 35
 
                                   (scaled)                 (unscaled)
Objective...............:  4.3396851027638400e-007   4.3396851027638400e-007
Dual infeasibility......:  7.0868901025603886e-005   7.0868901025603886e-005
Constraint violation....:  0.0000000000000000e+000   0.0000000000000000e+000
Complementarity.........:  0.0000000000000000e+000   0.0000000000000000e+000
Overall NLP error.......:  7.0868901025603886e-005   7.0868901025603886e-005
 
 
Number of objective function evaluations             = 514
Number of objective gradient evaluations             = 36
Number of equality constraint evaluations            = 0
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 0
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 0
Total CPU secs in IPOPT (w/o function evaluations)   =      1.846
Total CPU secs in NLP function evaluations           =     33.874
 
EXIT: Optimal Solution Found.
 
 
*** Ipopt succeeded
  number of required edges : 0
 write geo in IP1.mesh.gmsh
  number of required edges : 0
 write geo in IPe.mesh.gmsh
Error: 0.0599336
times: compile 1.567s, execution 37.487s,  mpirank:0
 ######## We forget of deleting   16097 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3463,  size :409888 mpirank: 0
Ok: Normal End
 try getConsole D:\Study\HUST\FEM\heatsource\FreeFem++\HeatSource1D_Q.edp
